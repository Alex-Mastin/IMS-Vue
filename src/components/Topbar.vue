<template>
    <header role="banner">
        <div id="header">
            <svg id="site-logo" x="0px" y="0px" width="342px" height="90px" viewBox="0 0 342 90">
                <path fill="#82BC00" d="M89.143,28.296c-3.798-2.095-8.398-3.113-14.063-3.113c-0.784,0-1.543,0.021-2.267,0.052l2.792-21.136  L62.287,8.613c-2.867,0.82-3.515,2.952-3.639,4.207l-2.212,15.068c-2.576,0.841-5.212,1.87-7.863,3.07  c-9.393,4.249-16.77,11.841-19.736,19.752c-1.983,5.29-1.915,10.529,0.197,15.149c3.378,7.39,11.625,11.802,22.062,11.802  c3.963,0,8.026-0.623,12.05-1.846c0.074-0.021-0.989,10.159-0.989,10.159l11.595-3.815c2.866-0.821,3.514-2.953,3.637-4.208  l1.607-12.77c9.488-3.125,17.007-11.534,18.233-20.689C98.159,37.546,95.212,31.642,89.143,28.296z"/>
                <path d="M87.191,30.626c-5.947-3.279-13.455-2.812-17.969-2.376l2.389-18.478l-0.293,0.126l-8.684,2.953h0.001  c-0.451,0.175-0.758,0.464-0.953,0.84c-0.004,0.002-0.017,0.037-0.017,0.037c-0.06,0.121-0.106,0.25-0.143,0.386l-0.046,0.02  l-2.27,16.099c-2.918,0.861-5.961,1.994-9.15,3.435C35.875,40.083,27.658,53.34,32.369,63.647  c4.208,9.206,17.152,12.035,29.932,8.156c0.096-0.028,1.271-0.344,1.367-0.375l0.01-0.317l4.709-36.418  c8.101-1.916,14.899-0.909,17.787,2.3c3.839,4.271,0.793,13.261-9.115,16.393l1.852-14.722L76.728,39.4l-4.85,1.605h0.001  c-0.392,0.154-0.664,0.406-0.832,0.735c-0.003,0.002-0.016,0.032-0.016,0.032c-0.101,0.211-0.166,0.446-0.188,0.711l-4.912,37.804  l6.729-2.255c0.991-0.27,1.429-0.769,1.502-1.629l1.824-14.493C91.982,58.037,100.493,37.961,87.191,30.626z M54.405,64.296  c-6.308,0.844-11.712-0.914-13.574-5.396c-2.551-6.138,2.488-13.466,11.108-18.157c2.256-1.227,4.584-2.23,6.138-2.782  L54.405,64.296z"/>
                <g>
	                <path stroke="#000000" stroke-miterlimit="10" d="M111.28,42.058h7.6c6.157,0,11.26,3.3,11.26,9.844c0,6.354-5.131,9.57-11.01,9.57   h-7.85V42.058z M116.272,57.368h2.579c3.716,0,5.769-2.053,5.769-5.466c0-3.41-2.053-5.74-5.769-5.74h-2.579V57.368z"/>
                    <path stroke="#000000" stroke-miterlimit="10" d="M137.958,53.762v3.578h9.179v4.133h-14.171V42.058h13.59v4.132h-8.597v3.439   h6.711v4.132H137.958z"/>
                    <path stroke="#000000" stroke-miterlimit="10" d="M157.315,54.955l3.993-12.897h5.047l-6.849,19.415h-4.299l-6.878-19.415h5.048   L157.315,54.955z"/>
                    <path stroke="#000000" stroke-miterlimit="10" d="M173.398,61.473h-5.047V42.058h5.047V61.473z"/>
                    <path stroke="#000000" stroke-miterlimit="10" d="M191.426,42.696V47.3c-1.139-0.638-2.413-1.054-4.3-1.054   c-4.076,0-5.657,2.773-5.657,5.547c0,2.801,1.607,5.629,5.657,5.629c1.887,0,3.051-0.165,4.3-0.72v4.41   c-1.498,0.47-3.218,0.638-4.632,0.638c-5.604,0-10.539-2.969-10.539-9.901c0-6.934,4.798-9.929,10.372-9.929   C188.707,41.92,189.845,42.225,191.426,42.696z"/>
                    <path stroke="#000000" stroke-miterlimit="10" d="M199.799,53.762v3.578h9.181v4.133h-14.172V42.058h13.59v4.132h-8.599v3.439   h6.712v4.132H199.799z"/>
                    <path fill="#82BC00" d="M217.964,42.058h5.657c3.162,0,7.044,1.276,7.044,6.074c0,4.854-3.882,6.211-6.823,6.211h-2.745v7.13   h-3.133V42.058z M221.097,51.57h2.774c1.636,0,3.521-0.693,3.521-3.438c0-2.718-1.886-3.355-3.521-3.355h-2.774V51.57z"/>
                    <path fill="#82BC00" d="M236.267,61.473h-3.161V42.058h3.161V61.473z"/>
                    <path fill="#82BC00" d="M246.75,61.473h-3.079V44.638h-5.354v-2.58h13.783v2.58h-5.351V61.473z"/>
                    <path fill="#82BC00" d="M259.339,61.75c-2.163,0-4.604-0.389-6.241-0.999v-2.662c1.305,0.444,3.827,1.025,5.991,1.025   c2.329,0,3.966-0.777,3.966-2.856c0-2.412-2.302-2.828-4.687-3.494c-2.44-0.693-4.881-1.747-4.881-5.491   c0-4.437,3.161-5.353,6.322-5.353c2.552,0,4.188,0.332,5.687,0.776l-0.028,2.69c-1.442-0.499-3.273-0.831-4.936-0.831   c-1.777,0-3.911,0.443-3.911,2.607c0,2.107,1.941,2.551,4.104,3.133c2.606,0.722,5.436,1.691,5.436,5.77   C266.161,60.668,262.693,61.75,259.339,61.75z"/>
                    <path fill="#82BC00" d="M275.591,61.473h-3.079V44.638h-5.354v-2.58h13.784v2.58h-5.351V61.473z"/>
                    <path fill="#82BC00" d="M290.787,41.92c5.797,0,10.067,3.854,10.067,9.9c0,6.047-4.271,9.93-10.067,9.93   c-5.796,0-10.066-3.883-10.066-9.93C280.721,45.774,284.991,41.92,290.787,41.92z M290.787,58.92c3.827,0,6.796-2.744,6.796-7.1   c0-4.354-2.969-7.072-6.796-7.072c-3.828,0-6.794,2.718-6.794,7.072C283.993,56.176,286.959,58.92,290.787,58.92z"/>
                    <path fill="#82BC00" d="M303.46,42.058h5.657c3.162,0,7.044,1.276,7.044,6.074c0,4.854-3.882,6.211-6.822,6.211h-2.745v7.13h-3.134   V42.058z M306.594,51.57h2.772c1.637,0,3.522-0.693,3.522-3.438c0-2.718-1.886-3.355-3.522-3.355h-2.772V51.57z"/>
                </g>
            </svg>
        </div>
        <div id="topbar">
            <div id="search-bar">
                <form id="search" autocomplete="off" @submit.prevent="search()">
                    <div id="search-left-half">
                            <span id="search-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" width="512" height="512" viewBox="0 0 512 512">
                                    <path d="M511.256 466.306L371.179 326.229a2.542 2.542 0 0 0-3.595 0l-11.513 11.512c31.591-35.855 50.786-82.878 50.786-134.312C406.856 91.26 315.6.001 203.428.001 91.257.001 0 91.26 0 203.43s91.257 203.426 203.428 203.426c51.432 0 98.457-19.196 134.314-50.783l-11.513 11.512a2.543 2.543 0 0 0 0 3.595l140.076 140.074a2.545 2.545 0 0 0 3.596 0l41.353-41.352a2.541 2.541 0 0 0 .002-3.596zm-307.828-92.508c-93.942 0-170.371-76.428-170.371-170.369s76.428-170.37 170.371-170.37c93.942 0 170.371 76.428 170.371 170.37S297.37 373.798 203.428 373.798z"></path>
                                </svg>
                                <span class="caret"></span>
                            </span>
                    </div>
                    <div>
                        <input id="search-right-half" placeholder="Search" maxlength="100" type="text" class="">
                        <input class="no-display" type="submit">
                    </div>
                </form>
                <search-options></search-options>
            </div>
            <a class="support right" @click="routeTo('/support')">
                <svg class="large" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M317.1 147.5c-15.1-13.8-35.5-20.8-60.5-20.8-23.7 0-43.1 6.5-57.7 19.4-14.6 12.9-23.5 31.5-26.4 55.5l-.6 4.9 40.4 4.8.7-4.6c2.5-15.8 7.7-27.5 15.4-34.7s17.1-10.7 28.7-10.7c12 0 21.9 3.9 30.1 11.9s12.2 16.9 12.2 27.3c0 5.6-1.3 10.7-4 15.4-2.8 4.9-9.3 11.9-19.3 20.7-10.7 9.4-17.9 16.5-22.1 21.5-5.8 7-10 14-12.6 20.8-3.5 9.1-5.3 19.9-5.3 32.3 0 2.1.1 5.1.2 9l.1 4.7h38.4l.1-4.8c.3-14.3 1.4-21.4 2.3-24.7 1.3-4.7 3.2-8.8 5.9-12.5 2.8-3.8 9-10 18.5-18.4 15.1-13.4 25.1-24.6 30.4-34.2 5.4-9.7 8.1-20.4 8.1-31.9 0-19.9-7.7-37-23-50.9zm-60.8 237.8c12.1 0 22-9.8 22-22 0-12.1-9.8-22-22-22-12.1 0-22 9.8-22 22s9.8 22 22 22z"></path><path d="M437.4 74.6C388.9 26.1 324.5-.5 256-.5S123.1 26.2 74.6 74.6C26.1 123.1-.5 187.5-.5 256s26.7 132.9 75.1 181.4c48.5 48.5 112.9 75.1 181.4 75.1s132.9-26.7 181.4-75.1c48.5-48.5 75.1-112.9 75.1-181.4s-26.6-132.9-75.1-181.4zm-22.6 340.2c-42.4 42.4-98.8 65.8-158.8 65.8s-116.4-23.4-158.8-65.8S31.5 316 31.5 256 54.8 139.6 97.2 97.2 196 31.5 256 31.5s116.4 23.4 158.8 65.8 65.8 98.8 65.8 158.8-23.4 116.3-65.8 158.7z"></path></svg>
            </a>
        </div>
    </header>
</template>

<script>
    import SearchOptions from "@/components/SearchOptions.vue";
    export default {
        name: "topbar",
        components: {
            SearchOptions
        },
        data() {
            return {
            }
        },
        methods: {
            search() {
                let query = document.querySelector("#search-right-half").value;
                let dataset = document.querySelector(".selected-option").innerText.trim();

                if (query) {
                    switch(dataset) {
                        case 'Store Stock':
                            this.routeTo('/storestock/search/?query=' + query);
                            break;
                        case 'Big Buys/Sales':
                            this.routeTo('/buysale/search/?query=' + query);
                            break;
                        case 'Returns':
                            this.routeTo('/returns/search/?query=' + query);
                            break;
                    }

                    // Reset search content
                    document.querySelector("#search-right-half").value = "";
                }


            },
            routeTo(route) {
                // Refreshes the page if a query has already been submitted.
                if (window.location.hash.includes("?query=")) {
                    this.$router.push(route);
                    this.$router.go();
                }
                else {
                    this.$router.push(route);
                }
            },
        },
    }
</script>

<style scoped>
    header {
        width: 100%;
        position: unset;
        background-color: #f7f7f7;
    }

    #header {
        top: 0;
        height: 3.1rem;
        width: 12.5rem;
        background-color: #ededed;
        z-index: 2;
        position: fixed;
    }

    #site-logo {
        width: inherit;
        height: inherit;
        display: block;
        background-size: 70%;
        background-color: #ededed;
        background-position: center;
    }

    #topbar {
        top: 0;
        left: 12.5rem;
        height: 3.05rem;
        width: 100%;
        background-color: #f8f7f7;
        position: fixed;
        z-index: 1;
    }

    #topbar, .ui {
        border-bottom: 1px solid #e0e0e0;
    }

    #search-bar {
        padding: 0.54rem;
        left: 2rem;
        height: 31px;
        position: relative;
        display: table;
    }

    #search-left-half {
        user-select: none;
        border-radius: 20px 0 0 20px;
        height: 29px;
        position: relative;
        background-color: #fff;
        border: 1px solid #ccc !important;
    }

    #search-icon {
        padding: 8px;
        position: absolute;
        color: #555;
        fill: #555;
        left: 0;
    }

    svg {
        margin-left: 3px;
        margin-right: 3px;
        height: 15px;
        width: 15px;
    }

    svg.large {
        height: 18px;
        width: 18px;
        fill: #222;
    }

    .caret {
        display: inline-block;
        position: relative;
        z-index: 3;
        width: 0;
        height: 0;
        left: -3px;
        vertical-align: middle;
        border: 4px solid;
        border-right: 4px solid transparent;
        border-left: 4px solid transparent;
        border-bottom: 4px solid transparent;
    }

    #search-right-half {
        height: 29px;
        border-radius: 0 20px 20px 0;
        border: 1px solid #ccc !important;
        border-left: 0 !important;
        padding: 0 2px;
        font-size: 15px;
        position: relative;
        bottom: 31px;
        left: 2.35rem;
        width: 218px;
        padding-left: 4px;
        font-family: 'Metropolis Regular';
        letter-spacing: -0.045rem;
    }

    .no-display {
        display: none;
    }

    .support {
        position: relative;
        left: -18em;
        top: -4.15em;
    }
</style>